# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–∞–±–æ—Ç–µ —Å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–º protobuf-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤

–≠—Ç–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –æ–ø–∏—Å—ã–≤–∞–µ—Ç **—Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è, —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏ —Å—Ç–∏–ª—è** –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ `.proto`-—Ñ–∞–π–ª–æ–≤, –∞ —Ç–∞–∫–∂–µ **–ª—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è API –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤** –Ω–∞ –æ—Å–Ω–æ–≤–µ [–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ protobuf](https://protobuf.dev/best-practices/).

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –∏ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

### üß© –û–¥–∏–Ω —Å–µ—Ä–≤–∏—Å ‚Äî –æ–¥–∏–Ω –º–æ–¥—É–ª—å

–ö–∞–∂–¥—ã–π –ª–æ–≥–∏—á–µ—Å–∫–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–π —Å–µ—Ä–≤–∏—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä, `user_service`, `auth`) –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Ñ–æ—Ä–º–ª–µ–Ω –∫–∞–∫ **–æ—Ç–¥–µ–ª—å–Ω—ã–π –º–æ–¥—É–ª—å**, —Ö—Ä–∞–Ω—è—â–∏–π —Å–≤–æ–π `.proto`-—Ñ–∞–π–ª –∏–ª–∏ –Ω–∞–±–æ—Ä —Ñ–∞–π–ª–æ–≤. –≠—Ç–æ —É–ø—Ä–æ—â–∞–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ, —É–º–µ–Ω—å—à–∞–µ—Ç —Å–≤—è–∑–∞–Ω–Ω–æ—Å—Ç—å –∏ –¥–µ–ª–∞–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ –±–µ–∑–æ–ø–∞—Å–Ω—ã–º–∏. –ü–æ–¥—Ä–æ–±–Ω–µ–µ ‚Äî –≤ [1-1-1 guideline](https://protobuf.dev/best-practices/1-1-1/).

–ü—Ä–∏–º–µ—Ä:
```
/proto
  /user_service
    /v1
      user_service.proto
  /auth
    /v1
      auth.proto
```

### üóÇ –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏

–î–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–∞–∂–æ—Ä–Ω—ã–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ –≤ API –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–∞–ø–∫–∏ `v1/`, `v2/` –∏ —Ç.–¥. –í –∫–∞–∂–¥–æ–π –∏–∑ –Ω–∏—Ö –¥–æ–ª–∂–Ω—ã —Å–æ–¥–µ—Ä–∂–∞—Ç—å—Å—è **—Ç–æ–ª—å–∫–æ** `.proto`-—Ñ–∞–π–ª—ã. 

–§–∞–π–ª—ã –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ (`.pb.go` –∏ –¥—Ä—É–≥–∏–µ) —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ `main` —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–∫—Ç—É–∞–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏.

### üì¶ –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ Go-–º–æ–¥—É–ª—è

–ï—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ Go, —Ç–æ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥—É–ª—è –≤ `go.mod` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `module github.com/example/user_service/v2`) –¥–æ–ª–∂–Ω–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å **—Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –ø–µ—Ä–µ—Ö–æ–¥–∞ –Ω–∞ –Ω–æ–≤—É—é –º–∞–∂–æ—Ä–Ω—É—é –≤–µ—Ä—Å–∏—é API**, –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å [semantic import versioning](https://go.dev/doc/modules/version-numbers).

–í–µ—Ä—Å–∏—è —Ç–∞–∫–∂–µ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—Ç—Ä–∞–∂–µ–Ω–∞ –≤–Ω—É—Ç—Ä–∏ `.proto` —Ñ–∞–π–ª–∞:

```proto
syntax = "proto3";

package user_service.v2;
```

–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–Ω–∏ –∏ —Ç–µ –∂–µ –∏–º–µ–Ω–∞ –º–µ—Ç–æ–¥–æ–≤ –∏ —Å–µ—Ä–≤–∏—Å–æ–≤ (`GetUser`, `UserService`) –≤ —Ä–∞–∑–Ω—ã—Ö –≤–µ—Ä—Å–∏—è—Ö –±–µ–∑ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤.

### üóÉ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, `.pb.go`, `.pb.ts`, `.pb.swift`) **–Ω–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ `main` –≤–µ—Ç–∫–µ** –¥–ª—è —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –≤–µ—Ä—Å–∏–π API. –û–Ω–∏ –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ **Git-—Ç–µ–≥–∏**, –Ω–∞–ø—Ä–∏–º–µ—Ä:

```
protobuf/user_service/v1.0.0
protobuf/auth/v2.1.3
```

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –æ—Å–Ω–æ–≤–Ω–∞—è –≤–µ—Ç–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –≤–µ—Ä—Å–∏–∏, –∞ –¥–æ—Å—Ç—É–ø –∫ –ø—Ä–µ–¥—ã–¥—É—â–∏–º –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `Releases`.

### üè∑ –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–µ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Ç–µ–≥–∏

–ö–∞–∂–¥—ã–π —Å–µ—Ä–≤–∏—Å –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä—É–µ—Ç—Å—è **–Ω–µ–∑–∞–≤–∏—Å–∏–º–æ** –∏ –ø–æ–ª—É—á–∞–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–µ **—Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ–≥–∏** (`vX.Y.Z`). –¢–µ–≥–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ—Ñ–æ—Ä–º–ª–µ–Ω—ã –≤ —Ñ–æ—Ä–º–∞—Ç–µ:

```
<–ø—É—Ç—å_–¥–æ_–º–æ–¥—É–ª—è>/v1.0.0
```

–ù–∞–ø—Ä–∏–º–µ—Ä:

```
protobuf/user_service/v1.0.0
protobuf/auth/v2.3.1
```

–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞—Ö –∏ –ø–æ–¥–∫–ª—é—á–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–¥–∞.

---

### ‚úÖ –ò–º–µ–Ω–æ–≤–∞–Ω–∏–µ

- –ù–∞–∑–≤–∞–Ω–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤ –≤—Å–µ–≥–¥–∞ –∑–∞–∫–∞–Ω—á–∏–≤–∞—é—Ç—Å—è –Ω–∞ `Service`
- –ù–∞–∑–≤–∞–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤ ‚Äî `*Request` –∏ `*Response`
- –í—Å–µ –≤—Ö–æ–¥–Ω—ã–µ –∏ –≤—ã—Ö–æ–¥–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã ‚Äî —ç—Ç–æ **–æ—Ç–¥–µ–ª—å–Ω—ã–µ `message`**, –¥–∞–∂–µ –µ—Å–ª–∏ –æ–Ω–∏ –ø—É—Å—Ç—ã–µ

**–ü—Ä–∏–º–µ—Ä:**

```proto
service UserService {
  rpc GetUser(GetUserRequest) returns (GetUserResponse);
}

message GetUserRequest {
  uint64 user_id = 1;
}

message GetUserResponse {
  string name = 1;
}
```

> –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö `Request`/`Response` —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–µ—Ç–æ–¥–∞ –æ–±–ª–µ–≥—á–∞–µ—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ API –≤ –±—É–¥—É—â–µ–º –∏ –¥–µ–ª–∞–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –æ–¥–Ω–æ–∑–Ω–∞—á–Ω—ã–º.

---

### üß± –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ–æ–±—â–µ–Ω–∏–π

#### üîπ –ü—É—Å—Ç—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è

–ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `google.protobuf.Empty`. –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª—è–π—Ç–µ —Å–≤–æ–∏ –ø—É—Å—Ç—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è:

```proto
message PingRequest {}

message PingResponse {}
```

–≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Ä–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å: –ø–æ–∑–∂–µ –≤—ã —Å–º–æ–∂–µ—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ –ø–æ–ª—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–∏–≥–Ω–∞—Ç—É—Ä—ã RPC.

#### üîπ –¢–∏–ø—ã –ø–æ–ª–µ–π

- **uint –≤–º–µ—Å—Ç–æ int**, –µ—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–µ –º–æ–≥—É—Ç –±—ã—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º–∏:

```proto
uint32 age = 1;
```

- **enum –≤—Å–µ–≥–¥–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç `_UNSPECIFIED` –∫–∞–∫ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:**

```proto
enum Status {
  STATUS_UNSPECIFIED = 0;
  STATUS_ACTIVE = 1;
  STATUS_INACTIVE = 2;
}
```

- **bool –ø–æ–ª—è ‚Äî —Å –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç—å—é.** –ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ —Ä–∞–∑–ª–∏—á–∞—Ç—å `false` –∏ "–Ω–µ –∑–∞–¥–∞–Ω–æ", –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `optional` –∏–ª–∏ `enum`.

```proto
optional bool is_active = 1;
```

–ò–õ–ò

```proto
enum ActiveState {
  ACTIVE_STATE_UNSPECIFIED = 0;
  ACTIVE = 1;
  INACTIVE = 2;
}
```

- **repeated –ø–æ–ª—è ‚Äî –≤—Å–µ–≥–¥–∞ –æ–±—ä–µ–∫—Ç—ã (`message`), –Ω–µ –ø—Ä–∏–º–∏—Ç–∏–≤—ã:**

–ù–µ–≤–µ—Ä–Ω–æ:
```proto
repeated string tags = 1;
```

–í–µ—Ä–Ω–æ:
```proto
message Tag {
  string value = 1;
}

message Product {
  repeated Tag tags = 1;
}
```

–¢–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤ –±—É–¥—É—â–µ–º –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—è –≤ `Tag`, –Ω–µ –ª–æ–º–∞—è –æ–±—Ä–∞—Ç–Ω—É—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å.

---

### üé® –°—Ç–∏–ª—å –∫–æ–¥–∞

- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `syntax = "proto3"`
- –ù–∞–∑–≤–∞–Ω–∏—è –ø–æ–ª–µ–π ‚Äî `snake_case`
- –ù–µ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–æ–º–µ—Ä–∞ —Ç–µ–≥–æ–≤
- –ù–µ –º–µ–Ω—è–π—Ç–µ —Ç–∏–ø—ã —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª–µ–π
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ –Ω–µ–±–æ–ª—å—à–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è ‚Äî –∏–∑–±–µ–≥–∞–π—Ç–µ `message` —Å —Å–æ—Ç–Ω—è–º–∏ –ø–æ–ª–µ–π
- –ö–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ `enum` –∏ –≤–∞–∂–Ω—ã–µ –ø–æ–ª—è –¥–ª—è –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

---

## üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [Best Practices Overview](https://protobuf.dev/best-practices/)
- [API Design Best Practices](https://protobuf.dev/best-practices/api/)
- [Dos and Don'ts](https://protobuf.dev/best-practices/dos-donts/)
- [1-1-1 Rule](https://protobuf.dev/best-practices/1-1-1/)

---

## üß™ –ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

```
/proto
  /auth
    /v1
      auth.proto
  /user_service
    /v1
      user_service.proto
    /v2
      user_service.proto
```

–ü—Ä–∏ —ç—Ç–æ–º `go.mod` –≤ `user_service/v2` –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —Ç–∞–∫:

```
module github.com/example/proto/user_service/v2
```

–ê `user_service/v2/user_service.proto` —Å–æ–¥–µ—Ä–∂–∏—Ç:

```proto
package user_service.v2;
```

---

## üìå –†–µ–∑—é–º–µ

| –ê—Å–ø–µ–∫—Ç                        | –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è                                                              |
|------------------------------|---------------------------------------------------------------------------|
| –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ              | –ü–∞–ø–∫–∏ `v1/`, `v2/` + —Ç–µ–≥ `path/to/service/vX.Y.Z`                         |
| go-–º–æ–¥—É–ª–∏                    | –û–±–Ω–æ–≤–ª—è—Ç—å —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –º–∞–∂–æ—Ä–Ω–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏ (`/v2` –≤ `go.mod`)               |
| –°–µ—Ä–≤–∏—Å—ã                      | –ù–∞–∑–≤–∞–Ω–∏–µ —Å `Service`                                                     |
| –ú–µ—Ç–æ–¥ + –≤—Ö–æ–¥/–≤—ã—Ö–æ–¥           | `Request` / `Response` —Å–æ–æ–±—â–µ–Ω–∏—è ‚Äî –≤—Å–µ–≥–¥–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–µ `message`            |
| Enum                         | –í—Å–µ–≥–¥–∞ —Å `*_UNSPECIFIED = 0`                                             |
| Bool                         | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `optional` –∏–ª–∏ `enum`, –Ω–µ raw `bool`                        |
| repeated                     | –û–±–æ—Ä–∞—á–∏–≤–∞—Ç—å –≤ `message`, –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∏–º–∏—Ç–∏–≤—ã –Ω–∞–ø—Ä—è–º—É—é              |
| –ü—É—Å—Ç—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è             | –ù–µ `Empty`, –∞ —Å–≤–æ—ë `message`                                             |
| –ò—Å—Ç–æ—Ä–∏—è                      | –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –ø–æ —Ç–µ–≥–∞–º, –Ω–µ –≤ `main`                     |
